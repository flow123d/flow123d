flow123d_version: 3.1.0
problem: !Coupling_Sequential
  description: Injection into 2 fractures differing in cross section.
  mesh:
    mesh_file: ../00_mesh/square_1frac.msh
  flow_equation: !Coupling_Iterative
    time:
      end_time: 10
    input_fields:
      - region: BULK
        biot_alpha: 1
        fluid_density: 1
        gravity: 1
    output_stream:
      file: iterative.pvd
      format: !vtk
        variant: ascii
    output:
      times:
        - step: 2
      fields:
        # - delta_min
        - pressure_potential
        # - output_test
        # - conductivity_model
        # - conductivity
    flow_equation: !Flow_Richards_LMH
        input_fields:
          - region: rock
            conductivity: 1e-3          
            storativity: 1
            delta_0: 1e-5
          - region: fracture
            conductivity: 1
            storativity: 1
            cross_section: 1e-3
            delta_0: 1e-5
          - region: .right_fl
            bc_type: dirichlet
            bc_pressure: 5
          - region: .left
            bc_type: dirichlet
            bc_pressure: 0
          # - region: .top
          #   bc_type: dirichlet
          #   bc_pressure: 1
          # - region: .bottom
          #   bc_type: dirichlet
          #   bc_pressure: 5
        nonlinear_solver:
          max_it: 1
          linear_solver: !Petsc
        output:
          times:
            - step: 2
          fields:
            - pressure_p0
            - velocity_p0
            - region_id
            - conductivity
            - updated_cross_section
        balance: {}
        output_stream: 
          file: flow_field.pvd
          format: !vtk
            variant: ascii
    mechanics_equation:
        input_fields:
          - region: rock
            young_modulus: 1e3
            poisson_ratio: 0.25
          - region: fracture
            young_modulus: 1
            poisson_ratio: 0.25
          - region: .left
            bc_type: displacement
            bc_displacement: 0
          - region: .top
            bc_type: traction
            bc_traction: [0, -10, 0]
          - region: .bottom
            bc_type: displacement
            bc_displacement: 0
        solver: !Petsc
        output_stream:
          file: mechanics.pvd
          format: !vtk
            variant: ascii
        output:
          times:
            - step: 2
          fields:
            - displacement
            - stress
            - cross_section_updated
            - displacement_divergence
            - region_id
